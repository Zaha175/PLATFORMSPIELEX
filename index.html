<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Spieleplattform Ultra - Eine Sammlung von kognitiven Tests und nÃ¼tzlichen Rechnern">
    <title>Spieleplattform Ultra mit Logo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css">
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.module.js"
            }
        }
    </script>
    <script>
        // Tailwind Configuration
        tailwind.config = {
            darkMode: 'class', // Enable dark mode based on class
            theme: {
                extend: {
                    colors: { // Custom color palette
                        primary: '#5D5CDE',
                        game: '#4CAF50',
                        test: '#FF9800',
                        utility: '#2196F3',
                        health: '#E91E63',
                        figuren: '#001a33',
                        farben: '#cc9900',
                        verkehr: '#003300',
                        mehrfach: '#cc6600',
                        grokflotte: '#660066',
                        reaktion: '#90EE90'
                    }
                }
            }
        }
    </script>
    <style>
        /* --- Base Styles --- */
        /* 3D Rotation Animation for Cards */
        @keyframes rotateCard {
            0% { transform: perspective(800px) rotateY(0deg); }
            100% { transform: perspective(800px) rotateY(360deg); }
        }

        /* Base Card Styling (Smaller, Compact) */
        .card {
            cursor: pointer;
            position: relative;
            overflow: hidden;
            width: 160px; /* Reduced width */
            height: 160px; /* Reduced height */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: box-shadow 0.3s ease; /* Smooth transitions ONLY for box-shadow */
            transform-style: preserve-3d;
            transform: perspective(800px) rotateY(0deg);
            padding: 0.75rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        /* Improved Card Hover Effect */
        .card:hover {
            animation: rotateCard 1s ease forwards;
            box-shadow: 0 16px 32px rgba(0, 0, 0, 0.4);
        }

        .card::before { content: none; }

        .card-content {
            position: relative;
            z-index: 1;
            text-align: center;
            backface-visibility: hidden;
            transform-style: preserve-3d;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }

        .card h3 {
             font-size: 0.8rem;
             margin-bottom: 0.25rem;
             font-weight: 600;
        }
        .card p { font-size: 0.65rem; }
        .card .icon-container {
             font-size: 1.25rem;
             margin-bottom: 0.5rem;
        }

        .test-card { border-left: 3px solid #FF9800; }
        .game-card { border-left: 3px solid #4CAF50; }
        .health-card { border-left: 3px solid #E91E63; }
        .utility-card { border-left: 3px solid #2196F3; }

        .main-bg { background-color: #f7fafc; }
        body.dark .main-bg { background-color: #1a202c; }

        .figuren-bg { background-color: #001a33; color: white; }
        .farben-bg { background-color: #cc9900; color: white; }
        .verkehr-bg { background-color: #003300; color: white; }
        .mehrfach-bg { background-color: #cc6600; color: white; }
        .grokflotte-bg { background-color: #660066; color: white; }
        .reaktion-bg { background-color: #90EE90; color: #333; }
        body.dark .health-card p, body.dark .utility-card p { color: #a0aec0; }
        body.dark .health-card h3, body.dark .utility-card h3 { color: #e2e8f0; }

        /* Ad Banner Styles */
        #ad-banner {
            text-align: center; padding: 10px; background-color: rgba(0, 51, 102, 0.8);
            color: #ffd700; margin: 10px auto; max-width: 95%; border-radius: 5px;
            border: 1px solid #ffd700; font-size: 1rem; font-weight: bold;
            min-height: 1.5em; cursor: default; position: relative; overflow: hidden;
            animation: pulse 3s infinite ease-in-out; z-index: 5;
        }
        @keyframes pulse {
             0% { box-shadow: 0 0 8px 0px rgba(255, 215, 0, 0.4); }
             50% { box-shadow: 0 0 16px 4px rgba(255, 215, 0, 0.6); }
             100% { box-shadow: 0 0 8px 0px rgba(255, 215, 0, 0.4); }
        }
        #ad-banner .text-glow { animation: textGlow 2s ease-in-out infinite alternate; }
        @keyframes textGlow {
            from { text-shadow: 0 0 4px #ffd700, 0 0 8px #ffd700; }
            to { text-shadow: 0 0 8px #ffd700, 0 0 16px #ffd700, 0 0 24px #ff9900; }
        }
        .cursor {
            display: inline-block; width: 2px; height: 1em; background-color: #ffd700;
            margin-left: 1px; animation: blink 1s infinite; vertical-align: bottom;
        }
        @keyframes blink { 0%, 49% { opacity: 1; } 50%, 100% { opacity: 0; } }
        body.dark #ad-banner {
            background-color: rgba(68, 68, 68, 0.8); border-color: #777;
            animation: pulseDark 3s infinite ease-in-out;
        }
        @keyframes pulseDark {
             0% { box-shadow: 0 0 8px 0px rgba(119, 119, 119, 0.4); }
             50% { box-shadow: 0 0 16px 4px rgba(119, 119, 119, 0.6); }
             100% { box-shadow: 0 0 8px 0px rgba(119, 119, 119, 0.4); }
        }
        body.dark .cursor { background-color: #ddd; }
        #ad-banner:hover { animation-play-state: paused; }
        #ad-banner:hover .text-glow { animation-play-state: paused; }

        /* Safari 3D Transform Support */
        @-webkit-keyframes rotateCard {
            0% { -webkit-transform: perspective(800px) rotateY(0deg); }
            100% { -webkit-transform: perspective(800px) rotateY(360deg); }
        }
        .card:hover { -webkit-animation: rotateCard 1s ease forwards; }

        /* --- Logo Styles --- */
        header {
            position: relative; /* Needed for absolute positioning of logo container */
        }
        #logo-container {
            position: absolute;
            top: 0.5rem;    /* Adjusted slightly */
            left: 0.5rem;     /* Adjusted slightly */
            width: 4rem;    /* Smaller base size */
            height: 4rem;   /* Smaller base size */
            z-index: 20;    /* Ensure logo is above header content */
            pointer-events: none; /* Container doesn't block clicks */
        }
        /* Responsive logo size */
        @media (min-width: 640px) { /* sm: */
            #logo-container {
                width: 5rem;  /* Slightly larger on sm screens */
                height: 5rem;
            }
        }
        #logo-canvas {
            display: block;
            width: 100%;
            height: 100%;
            cursor: pointer;
            pointer-events: auto; /* Canvas receives clicks */
        }

        /* --- Mobile Responsiveness --- */
        @media (max-width: 640px) { /* sm breakpoint */
             .card { width: calc(50% - 0.5rem); height: 140px; margin-bottom: 0.75rem; }
             #ad-banner { font-size: 0.9rem; }
             #games-container, #calc-container { display: flex; flex-wrap: wrap; justify-content: space-between; gap: 0; }
             .container { padding-left: 0.5rem; padding-right: 0.5rem; }
             .tab-button { padding: 0.5rem 0.75rem; font-size: 0.875rem; }
             /* Adjust header padding slightly if logo overlaps too much */
             header .container { padding-left: 4.5rem; } /* Add padding to header content to avoid logo overlap */
        }
        @media (min-width: 641px) and (max-width: 1024px) { /* md screens */
             .card { width: calc(33.33% - 1rem); height: 150px; margin-bottom: 1rem; }
              #games-container, #calc-container { display: flex; flex-wrap: wrap; justify-content: space-between; gap: 0; }
              /* Adjust header padding */
              header .container { padding-left: 6rem; }
        }
         @media (min-width: 1025px) { /* lg screens */
             .card { width: calc(20% - 0.8rem); height: 160px; }
              #games-container, #calc-container { display: flex; flex-wrap: wrap; justify-content: flex-start; gap: 1rem; }
              /* Adjust header padding */
              header .container { padding-left: 6rem; }
         }
    </style>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200 main-bg min-h-screen">
    <header class="bg-white dark:bg-gray-800 shadow-md p-4 sticky top-0 z-10">
        <div id="logo-container">
            <canvas id="logo-canvas"></canvas>
        </div>
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl md:text-2xl font-bold text-primary">Spieleplattform Ultra <span class="text-xs bg-primary text-white px-2 py-1 rounded ml-1 align-middle">CUB</span></h1>
            <button id="darkModeToggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary">
                <i class="fas fa-sun text-yellow-500 dark:hidden"></i>
                <i class="fas fa-moon text-blue-300 hidden dark:block"></i>
                <span class="sr-only">Toggle Dark Mode</span>
            </button>
        </div>
    </header>

    <main class="container mx-auto p-4">
        <div id="ad-banner">
            <span class="text-glow"></span><span class="cursor"></span>
        </div>

        <div class="mb-6 flex gap-2 overflow-x-auto pb-2 mt-4">
            <button id="all-tab" class="tab-button px-3 py-1 md:px-4 md:py-2 text-sm md:text-base bg-primary text-white rounded-md whitespace-nowrap">Alle</button>
            <button id="games-tab" class="tab-button px-3 py-1 md:px-4 md:py-2 text-sm md:text-base bg-gray-200 dark:bg-gray-700 rounded-md whitespace-nowrap">Spiele & Tests</button>
            <button id="calc-tab" class="tab-button px-3 py-1 md:px-4 md:py-2 text-sm md:text-base bg-gray-200 dark:bg-gray-700 rounded-md whitespace-nowrap">Rechner</button>
        </div>

        <div class="mb-6">
            <div class="relative">
                <input type="text" id="search" placeholder="Suche nach Spielen, Tests oder Rechnern..." class="w-full p-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-800 text-sm md:text-base focus:outline-none focus:ring-2 focus:ring-primary dark:focus:border-primary">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i class="fas fa-search text-gray-400"></i>
                </div>
            </div>
        </div>

        <div class="flex flex-col">
            <div class="w-full">
                <section id="games-section" class="mb-8">
                    <h2 class="text-lg md:text-xl font-bold mb-4 flex items-center"><i class="fas fa-gamepad mr-2 text-primary"></i> Spiele und Tests</h2>
                    <div id="games-container" class="flex flex-wrap justify-start gap-4">
                        <div class="card test-card figuren-bg" data-id="figurenvergleichstest1" onclick="window.open('https://zaha175.github.io/FIGURENVERGLEICHSTEST/', '_blank')" title="Figurenvergleichstest 1 starten">
                            <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-shapes"></i></div>
                                <h3>Figurenvergleichstest 1</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                            </div>
                        </div>
                         <div class="card test-card figuren-bg" data-id="figurenvergleichstest2" onclick="window.open('https://zaha175.github.io/FIGURENVERGLEICHSTEST1/', '_blank')" title="Figurenvergleichstest 2 starten">
                            <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-shapes"></i></div>
                                <h3>Figurenvergleichstest 2</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                            </div>
                        </div>
                         <div class="card test-card figuren-bg" data-id="figurenvergleichstest3" onclick="window.open('https://zaha175.github.io/FIGURENVERGLEICHSTEST2/', '_blank')" title="Figurenvergleichstest 3 starten">
                            <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-shapes"></i></div>
                                <h3>Figurenvergleichstest 3</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                            </div>
                        </div>
                        <div class="card test-card figuren-bg" data-id="figurenultra" onclick="window.open('https://zaha175.github.io/FIGURENVERGLEICHSTESTULTRA/', '_blank')" title="FIGURENULTRA starten">
                             <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-shapes"></i></div>
                                <h3>FIGURENULTRA</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                             </div>
                        </div>
                        <div class="card test-card figuren-bg" data-id="figurenultra1" onclick="window.open('https://zaha175.github.io/FIGURENVERGLEICHSTESTULTRA1/', '_blank')" title="FIGURENULTRA 1 starten">
                             <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-shapes"></i></div>
                                <h3>FIGURENULTRA1</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                             </div>
                        </div>
                        <div class="card test-card figuren-bg" data-id="figurenultra2" onclick="window.open('https://zaha175.github.io/FIGURENVERGLEICHSTESTULTRA2/', '_blank')" title="FIGURENULTRA 2 starten">
                             <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-shapes"></i></div>
                                <h3>FIGURENULTRA2</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                             </div>
                        </div>

                        <div class="card test-card farben-bg" data-id="farbentest1" onclick="window.open('https://zaha175.github.io/FARBENTEST1/', '_blank')" title="Farbentest 1 starten">
                             <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-palette"></i></div>
                                <h3>Farbentest 1</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                             </div>
                        </div>
                        <div class="card test-card farben-bg" data-id="farbentest2" onclick="window.open('https://zaha175.github.io/FARBENTEST2/', '_blank')" title="Farbentest 2 starten">
                             <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-palette"></i></div>
                                <h3>Farbentest 2</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                             </div>
                        </div>
                         <div class="card test-card farben-bg" data-id="farbentestultra2" onclick="window.open('https://zaha175.github.io/FARBENTESTULTRA2/', '_blank')" title="Farbentest ULTRA 2 starten">
                             <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-palette"></i></div>
                                <h3>Farbentest ULTRA 2</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                             </div>
                        </div>
                        <div class="card test-card farben-bg" data-id="farbentest3" onclick="window.open('https://zaha175.github.io/FARBENTEST3/', '_blank')" title="Farbentest 3 starten">
                             <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-palette"></i></div>
                                <h3>Farbentest 3</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                             </div>
                        </div>
                        <div class="card test-card farben-bg" data-id="farbenfigurentest1" onclick="window.open('https://zaha175.github.io/FARBFIGURENVERGLEICHSTESTULTRA/', '_blank')" title="Farbenfigurentest 1 starten">
                            <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-paint-brush"></i></div>
                                <h3>Farbenfigurentest 1</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                            </div>
                        </div>
                        <div class="card test-card farben-bg" data-id="farbenfigurentest2" onclick="window.open('https://zaha175.github.io/FARBFIGURENVERGLEICHSTEST3DULTRA/', '_blank')" title="Farbenfigurentest 2 starten">
                            <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-paint-brush"></i></div>
                                <h3>Farbenfigurentest 2</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                            </div>
                        </div>

                        <div class="card test-card verkehr-bg" data-id="verkehrsituationstest1" onclick="window.open('https://zaha175.github.io/Verkehrssituationstext/', '_blank')" title="Verkehrsituationstest 1 starten">
                            <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-car"></i></div>
                                <h3>Verkehrsituationstest 1</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                            </div>
                        </div>
                        <div class="card test-card verkehr-bg" data-id="verkehrsituationstest2" onclick="window.open('https://zaha175.github.io/PUZZLEBILDAPP/', '_blank')" title="Verkehrsituationstest 2 starten">
                             <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-car"></i></div>
                                <h3>Verkehrsituationstest 2</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                             </div>
                        </div>
                         <div class="card test-card verkehr-bg" data-id="verkehrsituationstest3" onclick="window.open('https://zaha175.github.io/PUZZLEVERKEHRSBILD3D/', '_blank')" title="Verkehrsituationstest 3 starten">
                            <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-car"></i></div>
                                <h3>Verkehrsituationstest 3</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                            </div>
                        </div>

                        <div class="card test-card mehrfach-bg" data-id="merhfachsituationstest1" onclick="window.open('https://zaha175.github.io/MERHFACHSITUATIONSTEST/', '_blank')" title="Mehrfachsituationstest 1 starten">
                            <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-tasks"></i></div>
                                <h3>Mehrfachsituationstest 1</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                            </div>
                        </div>
                         <div class="card test-card mehrfach-bg" data-id="merhfachsituationstest2" onclick="window.open('https://zaha175.github.io/MEHRFACHSITUATIONSTEST1/', '_blank')" title="Mehrfachsituationstest 2 starten">
                            <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-tasks"></i></div>
                                <h3>Mehrfachsituationstest 2</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                            </div>
                        </div>
                        <div class="card test-card mehrfach-bg" data-id="merhfachsituationstest3" onclick="window.open('https://zaha175.github.io/MEHRFACHSITUATIONSTEST2/', '_blank')" title="Mehrfachsituationstest 3 starten">
                            <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-tasks"></i></div>
                                <h3>Mehrfachsituationstest 3</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                            </div>
                        </div>

                        <div class="card test-card reaktion-bg" data-id="reaktionstest1" onclick="window.open('https://zaha175.github.io/Reaktionstest0/', '_blank')" title="Reaktionstest 1 starten">
                             <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-bolt"></i></div>
                                <h3>Reaktionstest 1</h3>
                                <p class="text-gray-700">Kategorie: Test</p>
                             </div>
                        </div>
                         <div class="card test-card reaktion-bg" data-id="reaktionstest2" onclick="window.open('https://zaha175.github.io/Reaktionstest2/', '_blank')" title="Reaktionstest 2 starten">
                            <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-bolt"></i></div>
                                <h3>Reaktionstest 2</h3>
                                <p class="text-gray-700">Kategorie: Test</p>
                            </div>
                        </div>
                         <div class="card test-card reaktion-bg" data-id="reaktionstest3" onclick="window.open('https://zaha175.github.io/Reaktionstest3NEU/', '_blank')" title="Reaktionstest 3 starten">
                            <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-bolt"></i></div>
                                <h3>Reaktionstest 3</h3>
                                <p class="text-gray-700">Kategorie: Test</p>
                            </div>
                        </div>

                         <div class="card test-card grokflotte-bg" data-id="grokflotte1" onclick="window.open('https://zaha175.github.io/GROKFLOTTE1/', '_blank')" title="Grokflotte 1 starten">
                             <div class="card-content">
                                <div class="icon-container text-orange-500"><i class="fas fa-ship"></i></div>
                                <h3>Grokflotte 1</h3>
                                <p class="text-gray-200">Kategorie: Test</p>
                             </div>
                         </div>
                         <div class="card test-card grokflotte-bg" data-id="grokflotte2" onclick="window.open('https://zaha175.github.io/GROKFLOTTE2/', '_blank')" title="Grokflotte 2 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-ship"></i></div><h3>Grokflotte 2</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="grokflotte3" onclick="window.open('https://zaha175.github.io/GROKFLOTTE3/', '_blank')" title="Grokflotte 3 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-ship"></i></div><h3>Grokflotte 3</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="grokflotte4" onclick="window.open('https://zaha175.github.io/GROKFLOTTE4/', '_blank')" title="Grokflotte 4 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-ship"></i></div><h3>Grokflotte 4</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="grokflotte5" onclick="window.open('https://zaha175.github.io/GROKFLOTTE5/', '_blank')" title="Grokflotte 5 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-ship"></i></div><h3>Grokflotte 5</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="grokflotte6" onclick="window.open('https://zaha175.github.io/GROKFLOTTE6/', '_blank')" title="Grokflotte 6 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-ship"></i></div><h3>Grokflotte 6</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="grokflotte7" onclick="window.open('https://zaha175.github.io/GROKFLOTTE7/', '_blank')" title="Grokflotte 7 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-ship"></i></div><h3>Grokflotte 7</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="grokflotte8" onclick="window.open('https://zaha175.github.io/GROKFLOTTE8/', '_blank')" title="Grokflotte 8 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-ship"></i></div><h3>Grokflotte 8</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="grokflotte9" onclick="window.open('https://zaha175.github.io/GROKFLOTTE9/', '_blank')" title="Grokflotte 9 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-ship"></i></div><h3>Grokflotte 9</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="grokflotte10" onclick="window.open('https://zaha175.github.io/GROKFLOTTE10/', '_blank')" title="Grokflotte 10 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-ship"></i></div><h3>Grokflotte 10</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="grokflotte11" onclick="window.open('https://zaha175.github.io/GROKFLOTTE11/', '_blank')" title="Grokflotte 11 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-ship"></i></div><h3>Grokflotte 11</h3><p class="text-gray-200">Kategorie: Test</p></div></div>


                         <div class="card test-card grokflotte-bg" data-id="galagaultra" onclick="window.open('https://zaha175.github.io/GALAGAULTRA/', '_blank')" title="GALAGAULTRA starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-space-shuttle"></i></div><h3>GALAGAULTRA</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="galagaultra1" onclick="window.open('https://zaha175.github.io/GALAGAULTRA1/', '_blank')" title="GALAGAULTRA 1 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-space-shuttle"></i></div><h3>GALAGAULTRA1</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="galagaultra2" onclick="window.open('https://zaha175.github.io/GALAGAULTRA2/', '_blank')" title="GALAGAULTRA 2 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-space-shuttle"></i></div><h3>GALAGAULTRA2</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="doom" onclick="window.open('https://zaha175.github.io/DOOM/', '_blank')" title="DOOM starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-crosshairs"></i></div><h3>DOOM</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="doom1" onclick="window.open('https://zaha175.github.io/DOOM1/', '_blank')" title="DOOM 1 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-crosshairs"></i></div><h3>DOOM1</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="doom2" onclick="window.open('https://zaha175.github.io/DOOM2/', '_blank')" title="DOOM 2 starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-crosshairs"></i></div><h3>DOOM2</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         <div class="card test-card grokflotte-bg" data-id="doom2" onclick="window.open('https://zaha175.github.io/HOSTFABRIK/', '_blank')" title="HOST FABRIK starten"> <div class="card-content"><div class="icon-container text-orange-500"><i class="fas fa-crosshairs"></i></div><h3>HOSTFABRIK</h3><p class="text-gray-200">Kategorie: Test</p></div></div>
                         
                        <div class="card game-card reaktion-bg" data-id="steinpapierschere" onclick="window.open('https://zaha175.github.io/STEINPAPIERSCHERE/', '_blank')" title="Stein Papier Schere spielen">
                             <div class="card-content">
                                <div class="icon-container text-green-500"><i class="fas fa-hand-rock"></i></div>
                                <h3>Stein Papier Schere</h3>
                                <p class="text-gray-700">Kategorie: Spiel</p>
                             </div>
                        </div>
                        <div class="card game-card reaktion-bg" data-id="pong" onclick="window.open('https://zaha175.github.io/PONG/', '_blank')" title="Pong spielen">
                             <div class="card-content">
                                <div class="icon-container text-green-500"><i class="fas fa-table-tennis"></i></div>
                                <h3>Pong</h3>
                                <p class="text-gray-700">Kategorie: Spiel</p>
                             </div>
                        </div>
                         <div class="card game-card reaktion-bg" data-id="pong1" onclick="window.open('https://zaha175.github.io/PONG1/', '_blank')" title="Pong 1 spielen"> <div class="card-content"><div class="icon-container text-green-500"><i class="fas fa-table-tennis"></i></div><h3>Pong1</h3><p class="text-gray-700">Kategorie: Spiel</p></div></div>
                         <div class="card game-card reaktion-bg" data-id="pong2" onclick="window.open('https://zaha175.github.io/PONG2/', '_blank')" title="Pong 2 spielen"> <div class="card-content"><div class="icon-container text-green-500"><i class="fas fa-table-tennis"></i></div><h3>Pong2</h3><p class="text-gray-700">Kategorie: Spiel</p></div></div>
                         <div class="card game-card reaktion-bg" data-id="pong3" onclick="window.open('https://zaha175.github.io/PONG3/', '_blank')" title="Pong 3 spielen"> <div class="card-content"><div class="icon-container text-green-500"><i class="fas fa-table-tennis"></i></div><h3>Pong3</h3><p class="text-gray-700">Kategorie: Spiel</p></div></div>
                         <div class="card game-card reaktion-bg" data-id="grokssnake" onclick="window.open('https://zaha175.github.io/GROKSSNAKE/', '_blank')" title="Grok's Snake spielen">
                            <div class="card-content">
                                <div class="icon-container text-green-500"><i class="fas fa-snake"></i></div>
                                <h3>Grok's Snake</h3>
                                <p class="text-gray-700">Kategorie: Spiel</p>
                            </div>
                         </div>
                         <div class="card game-card reaktion-bg" data-id="moduleverbinden" onclick="window.open('https://zaha175.github.io/WESTWORLDMODULEVERBINDEN/', '_blank')" title="MODULEVERBINDEN spielen"> <div class="card-content"><div class="icon-container text-green-500"><i class="fas fa-puzzle-piece"></i></div><h3>MODULEVERBINDEN</h3><p class="text-gray-700">Kategorie: Spiel</p></div></div>
                         <div class="card game-card reaktion-bg" data-id="moduleverbinden1" onclick="window.open('https://zaha175.github.io/WESTWORLDMODULEULTRA/', '_blank')" title="MODULEVERBINDEN 1 spielen"> <div class="card-content"><div class="icon-container text-green-500"><i class="fas fa-puzzle-piece"></i></div><h3>MODULEVERBINDEN1</h3><p class="text-gray-700">Kategorie: Spiel</p></div></div>
                         <div class="card game-card reaktion-bg" data-id="moduleverbinden2" onclick="window.open('https://zaha175.github.io/RASENMAEHERMANN/', '_blank')" title="MODULEVERBINDEN 2 spielen"> <div class="card-content"><div class="icon-container text-green-500"><i class="fas fa-puzzle-piece"></i></div><h3>MODULEVERBINDEN2</h3><p class="text-gray-700">Kategorie: Spiel</p></div></div>
                        <div class="card game-card reaktion-bg" data-id="breakoutultra" onclick="window.open('https://zaha175.github.io/BREAKOUTULTRA/', '_blank')" title="Breakout Ultra spielen">
                            <div class="card-content">
                                <div class="icon-container text-green-500"><i class="fas fa-gamepad"></i></div>
                                <h3>Breakout Ultra</h3>
                                <p class="text-gray-700">Kategorie: Spiel</p>
                            </div>
                         </div>
                         <div class="card game-card reaktion-bg" data-id="tetrix1" onclick="window.open('https://zaha175.github.io/TETRIX1/', '_blank')" title="Tetrix 1 spielen">
                            <div class="card-content">
                                <div class="icon-container text-green-500"><i class="fas fa-cube"></i></div>
                                <h3>Tetrix 1</h3>
                                <p class="text-gray-700">Kategorie: Spiel</p>
                            </div>
                         </div>
                         <div class="card game-card reaktion-bg" data-id="tetrix" onclick="window.open('https://zaha175.github.io/TETRIX/', '_blank')" title="Tetrix spielen">
                            <div class="card-content">
                                <div class="icon-container text-green-500"><i class="fas fa-cube"></i></div>
                                <h3>Tetrix</h3>
                                <p class="text-gray-700">Kategorie: Spiel</p>
                            </div>
                         </div>
                    </div>
                </section>

                <section id="calc-section" class="mb-8">
                    <h2 class="text-lg md:text-xl font-bold mb-4 flex items-center"><i class="fas fa-calculator mr-2 text-primary"></i> Rechner</h2>
                    <div id="calc-container" class="flex flex-wrap justify-start gap-4">
                        <div class="card health-card bg-white dark:bg-gray-800" data-id="alkoholkonsumrechner" onclick="window.open('https://zaha175.github.io/MENGENACHPROMILLE/', '_blank')" title="Alkoholkonsum-Rechner Ã¶ffnen">
                            <div class="card-content">
                                <div class="icon-container text-pink-500"><i class="fas fa-wine-glass"></i></div>
                                <h3>Alkoholkonsum-Rechner</h3>
                                <p class="text-gray-500 dark:text-gray-400">Kategorie: Gesundheit</p>
                            </div>
                        </div>
                        <div class="card health-card bg-white dark:bg-gray-800" data-id="promillerechner" onclick="window.open('https://zaha175.github.io/PROMILLERECHNERDE/', '_blank')" title="Promille-Rechner Ã¶ffnen">
                            <div class="card-content">
                                <div class="icon-container text-pink-500"><i class="fas fa-wine-bottle"></i></div>
                                <h3>Promille-Rechner</h3>
                                <p class="text-gray-500 dark:text-gray-400">Kategorie: Gesundheit</p>
                            </div>
                        </div>
                        <div class="card utility-card bg-white dark:bg-gray-800" data-id="lebensalterrechner" onclick="window.open('https://zaha175.github.io/LEBENSALTER-RECHNER/', '_blank')" title="Lebensalter-Rechner Ã¶ffnen">
                            <div class="card-content">
                                <div class="icon-container text-blue-500"><i class="fas fa-birthday-cake"></i></div>
                                <h3>Lebensalter-Rechner</h3>
                                <p class="text-gray-500 dark:text-gray-400">Kategorie: Utility</p>
                            </div>
                        </div>
                      <div class="card utility-card bg-white dark:bg-gray-800" data-id="lebensalterrechner" onclick="window.open('https://zaha175.github.io/FITNESSTRACKER/', '_blank')" title="FITNESSTACKER">
                            <div class="card-content">
                                <div class="icon-container text-blue-500"><i class="fas fa-birthday-cake"></i></div>
                                <h3>FITNESSTRACKER</h3>
                                <p class="text-gray-500 dark:text-gray-400">Kategorie: Utility</p>
                            </div>
                        </div> 
                    </div>
                </section>
                 <div id="no-results-container"></div>
            </div>
        </div>
    </main>

    <footer class="bg-white dark:bg-gray-800 py-4 border-t border-gray-200 dark:border-gray-700 mt-8">
        <div class="container mx-auto px-4 text-center text-sm text-gray-600 dark:text-gray-400">
            <p>Â© 2025 Spieleplattform Ultra</p>
        </div>
    </footer>

    <script>
        // --- DOM Element References ---
        const darkModeToggle = document.getElementById('darkModeToggle');
        const docElement = document.documentElement;
        const bodyElement = document.body; // Reference body for class toggling
        const allTab = document.getElementById('all-tab');
        const gamesTab = document.getElementById('games-tab');
        const calcTab = document.getElementById('calc-tab');
        const gamesSection = document.getElementById('games-section');
        const calcSection = document.getElementById('calc-section');
        const gamesContainer = document.getElementById('games-container'); // Container for game cards
        const calcContainer = document.getElementById('calc-container'); // Container for calc cards
        const noResultsContainer = document.getElementById('no-results-container'); // Dedicated container for message
        const tabs = [allTab, gamesTab, calcTab];
        const searchInput = document.getElementById('search');
        const allCards = document.querySelectorAll('.card'); // Select all cards initially
        const adBanner = document.getElementById("ad-banner");
        const textGlowElement = document.querySelector("#ad-banner .text-glow");
        const cursorElement = document.querySelector("#ad-banner .cursor");

        // --- State Variables ---
        let noResultsDiv = null; // To hold the 'no results' message div
        let typeTimeout;
        let eraseTimeout;
        let nextTextTimeout;
        let isTypingPaused = false;
        let currentAdIndex = 0;

        // --- Ad Banner Messages ---
        const adMessages = [
            "Spieleplattform Ultra: Alle Spiele und Tests im Vergleich!",
            "ðŸš€ SPIELE UND TEST ZENTRALE: Dein All-in-One-Tool fÃ¼r alle Bereiche!",
            "ðŸŽ® Neue Reaktionstests und Spiele jetzt verfÃ¼gbar!",
            "ðŸ§  Fordere dich heraus: Kognitive Tests fÃ¼r jedes Level!",
            "ðŸ’¡ Entdecke nÃ¼tzliche Rechner fÃ¼r den Alltag!"
        ];

        // --- Functions ---

        /**
         * Applies the selected theme (dark/light) to the document and saves preference.
         * @param {boolean} isDark - True if dark mode should be applied, false otherwise.
         */
        function applyTheme(isDark) {
          docElement.classList.toggle('dark', isDark);
          bodyElement.classList.toggle('dark', isDark); // Toggle on body as well
          localStorage.setItem('darkMode', isDark);
        }

        /**
         * Updates the visual state of the navigation tabs.
         * @param {HTMLElement} activeTab - The tab element that should be marked active.
         */
        function updateTabs(activeTab) {
            tabs.forEach(tab => {
                tab.classList.remove('bg-primary', 'text-white');
                tab.classList.add('bg-gray-200', 'dark:bg-gray-700');
            });
            activeTab.classList.remove('bg-gray-200', 'dark:bg-gray-700');
            activeTab.classList.add('bg-primary', 'text-white');
        }

        /**
         * Filters the visible cards based on search term and active tab.
         * @param {string} searchTerm - The term to filter by.
         */
        function filterCards(searchTerm) {
             searchTerm = searchTerm.toLowerCase();
             let hasVisibleGames = false;
             let hasVisibleCalcs = false;
             const currentActiveTab = document.querySelector('#all-tab.bg-primary, #games-tab.bg-primary, #calc-tab.bg-primary');

             allCards.forEach(card => {
                 const titleElement = card.querySelector('h3'); // Get the h3 element
                 // Ensure titleElement exists before accessing textContent
                 const title = titleElement ? titleElement.textContent.toLowerCase() : '';

                 const categoryTag = card.querySelector('p');
                 // Check if categoryTag exists before accessing textContent
                 const category = categoryTag ? categoryTag.textContent.toLowerCase() : '';
                 const cardIsGameOrTest = card.closest('#games-section') !== null;
                 const cardIsCalc = card.closest('#calc-section') !== null;

                 // Card is potentially visible if title or category matches search term
                 let isPotentiallyVisible = title.includes(searchTerm) || category.includes(searchTerm);

                 // Final visibility depends on potential visibility AND active tab
                 let isVisible = false;
                 if (isPotentiallyVisible) {
                     if (currentActiveTab === allTab) {
                         isVisible = true;
                     } else if (currentActiveTab === gamesTab && cardIsGameOrTest) {
                         isVisible = true;
                     } else if (currentActiveTab === calcTab && cardIsCalc) {
                         isVisible = true;
                     }
                 }

                 card.classList.toggle('hidden', !isVisible);

                 // Track if any cards are visible within each section
                 if (isVisible) {
                     if (cardIsGameOrTest) hasVisibleGames = true;
                     if (cardIsCalc) hasVisibleCalcs = true;
                 }
             });

             // Show/hide entire sections based on whether *any* card within them is visible *for the current filter*
             // Hide section only if the specific tab is active AND no cards are visible
             gamesSection.classList.toggle('hidden', !hasVisibleGames && currentActiveTab === gamesTab);
             calcSection.classList.toggle('hidden', !hasVisibleCalcs && currentActiveTab === calcTab);
             // Special case: If 'All' is active, show sections if they have *any* visible cards matching the search
             if (currentActiveTab === allTab) {
                 gamesSection.classList.toggle('hidden', !hasVisibleGames);
                 calcSection.classList.toggle('hidden', !hasVisibleCalcs);
             }


             // --- Handle "No results" message ---
             // Show message if search is active AND no cards are visible for the current tab filter
             const noResultsVisible = (currentActiveTab === allTab && !hasVisibleGames && !hasVisibleCalcs && searchTerm !== '') ||
                                      (currentActiveTab === gamesTab && !hasVisibleGames && searchTerm !== '') ||
                                      (currentActiveTab === calcTab && !hasVisibleCalcs && searchTerm !== '');

             if (noResultsVisible) {
                 if (!noResultsDiv) { // Create the div if it doesn't exist
                     noResultsDiv = document.createElement('div');
                     noResultsDiv.id = 'no-results';
                     // Apply centering and text styles
                     noResultsDiv.className = 'text-center py-12 text-gray-500 dark:text-gray-400 w-full';
                     noResultsDiv.innerHTML = `
                         <i class="fas fa-search fa-3x mb-4 opacity-50"></i>
                         <p class="text-lg font-semibold">Keine Ergebnisse gefunden</p>
                         <p class="text-sm">FÃ¼r "" wurden keine EintrÃ¤ge gefunden.</p>
                     `;
                     noResultsContainer.appendChild(noResultsDiv); // Append to the dedicated container
                 }
                 noResultsDiv.classList.remove('hidden'); // Make sure it's visible
                 // Update the search term in the message safely
                 const searchTermElement = noResultsDiv.querySelector('.text-sm');
                 if (searchTermElement) {
                    searchTermElement.textContent = `FÃ¼r "${searchInput.value}" wurden keine EintrÃ¤ge gefunden.`;
                 }
             } else if (noResultsDiv) {
                 noResultsDiv.classList.add('hidden'); // Hide the message if there are results or search is empty
             }
        }

        /**
         * Simulates a typewriter effect for the ad banner.
         * @param {HTMLElement} textElement - The element to display the text in.
         * @param {HTMLElement} cursorElement - The cursor element.
         * @param {string} text - The text to type.
         * @param {number} speed - Typing speed in milliseconds.
         * @param {function} callback - Function to call after typing and erasing.
         */
        function typeWriter(textElement, cursorElement, text, speed = 60, callback) {
            clearTimeout(typeTimeout);
            clearTimeout(eraseTimeout);
            clearTimeout(nextTextTimeout);

            let i = 0;
            textElement.innerHTML = ""; // Clear previous text
            cursorElement.style.display = "inline-block"; // Show cursor
            cursorElement.style.animationPlayState = "running"; // Start blinking

            function typing() {
                if (isTypingPaused) return; // Stop if paused by hover
                if (i < text.length) {
                    textElement.innerHTML += text.charAt(i);
                    i++;
                    typeTimeout = setTimeout(typing, speed); // Schedule next character
                } else {
                    cursorElement.style.animationPlayState = "paused"; // Pause cursor blink at end
                    // Wait 3 seconds after typing finishes, then start erasing
                    eraseTimeout = setTimeout(() => {
                         if (!isTypingPaused) eraseText(textElement, cursorElement, speed / 2, callback);
                     }, 3000);
                }
            }
            typing(); // Start the typing process
         }

        /**
         * Simulates erasing text in the ad banner.
         * @param {HTMLElement} textElement - The element containing the text.
         * @param {HTMLElement} cursorElement - The cursor element.
         * @param {number} speed - Erasing speed in milliseconds.
         * @param {function} callback - Function to call after erasing finishes.
         */
         function eraseText(textElement, cursorElement, speed, callback) {
             clearTimeout(eraseTimeout);
             cursorElement.style.animationPlayState = "running"; // Resume blinking

             function erasing() {
                 if (isTypingPaused) return; // Stop if paused by hover
                 if (textElement.innerHTML.length > 0) {
                     textElement.innerHTML = textElement.innerHTML.slice(0, -1); // Remove last character
                     eraseTimeout = setTimeout(erasing, speed); // Schedule next erase step
                 } else {
                      cursorElement.style.display = "none"; // Hide cursor when text is empty
                      // Wait briefly before calling the callback (e.g., nextText)
                      if (callback) {
                           nextTextTimeout = setTimeout(() => {
                               if (!isTypingPaused) callback();
                           }, 500); // 0.5 second pause
                      }
                 }
             }
             erasing(); // Start the erasing process
         }

        /**
         * Loads the next message in the ad banner sequence.
         */
        function nextText() {
            currentAdIndex = (currentAdIndex + 1) % adMessages.length; // Cycle through messages
            typeWriter(textGlowElement, cursorElement, adMessages[currentAdIndex], 60, nextText); // Start typing next message
        }

        // --- Event Listeners ---

        // Dark Mode Toggle Button
        darkModeToggle.addEventListener('click', () => {
            applyTheme(!docElement.classList.contains('dark'));
        });

        // Tab Navigation Buttons
        allTab.addEventListener('click', () => {
            updateTabs(allTab);
            filterCards(searchInput.value); // Re-filter based on current search
        });
        gamesTab.addEventListener('click', () => {
            updateTabs(gamesTab);
            filterCards(searchInput.value); // Re-filter based on current search
        });
        calcTab.addEventListener('click', () => {
            updateTabs(calcTab);
            filterCards(searchInput.value); // Re-filter based on current search
        });

        // Search Input Field
        searchInput.addEventListener('input', () => {
             filterCards(searchInput.value);
        });

        // Pause/Resume Banner Animation on Hover
         adBanner.addEventListener("mouseenter", () => {
             isTypingPaused = true;
             adBanner.style.animationPlayState = "paused"; // Pause pulse
             textGlowElement.style.animationPlayState = "paused"; // Pause glow
             cursorElement.style.animationPlayState = "paused"; // Pause blink
             clearTimeout(typeTimeout); // Stop typing timeout
             clearTimeout(eraseTimeout); // Stop erasing timeout
             clearTimeout(nextTextTimeout); // Stop next text timeout
         });

         adBanner.addEventListener("mouseleave", () => {
             isTypingPaused = false;
             adBanner.style.animationPlayState = "running"; // Resume pulse
             textGlowElement.style.animationPlayState = "running"; // Resume glow

             // Resume typing/erasing logic (simplified: restart current message cycle)
             const currentTextLength = textGlowElement.textContent.length;
             // Ensure adMessages[currentAdIndex] exists before accessing length
             const targetTextLength = adMessages[currentAdIndex] ? adMessages[currentAdIndex].length : 0;


             if (currentTextLength > 0 && currentTextLength < targetTextLength) {
                 // If partially typed, continue typing (restart for simplicity)
                 typeWriter(textGlowElement, cursorElement, adMessages[currentAdIndex], 60, nextText);
             } else if (currentTextLength === targetTextLength && targetTextLength > 0) { // Check targetTextLength > 0
                 // If fully typed (was waiting to erase), start erasing after a short delay
                 cursorElement.style.animationPlayState = "paused"; // Keep cursor paused briefly
                 eraseTimeout = setTimeout(() => {
                     if (!isTypingPaused) eraseText(textGlowElement, cursorElement, 30, nextText);
                 }, 1000);
             } else if (currentTextLength > 0) {
                 // If partially erased, continue erasing
                 eraseText(textGlowElement, cursorElement, 30, nextText);
             } else {
                 // If fully erased (was waiting for next), start next text
                 nextText();
             }
         });

        // --- Initialisation ---

        // Check initial theme preference
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const storedMode = localStorage.getItem('darkMode');
        applyTheme(storedMode === 'true' || (storedMode === null && prefersDark));

        // Start the banner animation cycle
        typeWriter(textGlowElement, cursorElement, adMessages[0], 60, nextText);

        // Apply initial filter (handles page reload with search term)
        filterCards(searchInput.value);

        // Set initial tab state
        updateTabs(allTab); // Default to 'All' tab

    </script>

    <script type="module">
        // Import Three.js via importmap
        import * as THREE from 'three';

        /**
         * Creates and animates the 3D logo.
         * @param {string} canvasId - The ID of the Canvas element for the logo.
         */
        function create3DLogo(canvasId) {
            let logoScene, logoCamera, logoRenderer, ring, vortex, particles = [], clock;

            // Initializes the scene, camera, renderer
            function init() {
                const canvas = document.getElementById(canvasId);
                if (!canvas) {
                    console.error(`Canvas mit ID "${canvasId}" nicht gefunden.`);
                    return;
                }
                const container = canvas.parentElement; // Get the container
                if (!container) {
                     console.error(`Container fÃ¼r Canvas mit ID "${canvasId}" nicht gefunden.`);
                     return;
                }

                logoScene = new THREE.Scene();

                // Camera setup (aspect ratio is set in resize)
                logoCamera = new THREE.PerspectiveCamera(60, container.clientWidth / container.clientHeight, 0.1, 1000);
                logoCamera.position.z = 15; // Adjust distance if needed

                // Renderer setup with transparent background
                logoRenderer = new THREE.WebGLRenderer({
                    antialias: true,
                    canvas: canvas,
                    alpha: true // Enable transparency
                });
                logoRenderer.setClearColor(0x000000, 0); // Fully transparent
                logoRenderer.setPixelRatio(window.devicePixelRatio); // Sharper on HiDPI displays
                // Set initial size (will be adjusted by resize)
                logoRenderer.setSize(container.clientWidth, container.clientHeight);


                createSceneElements(); // Create the 3D objects
                setupInteractions();   // Add interactivity
                clock = new THREE.Clock();
                animate(); // Start the animation loop
            }

            // Creates the geometric elements of the logo
            function createSceneElements() {
                // Kerr ring (outer ring)
                const ringGeometry = new THREE.TorusGeometry(4, 0.7, 32, 100);
                // Material with metallic sheen
                const ringMaterial = new THREE.MeshStandardMaterial({
                     color: 0x00ff99, // Greenish color
                     emissive: 0x00cc77, // Emissive color
                     emissiveIntensity: 0.6,
                     metalness: 0.8,
                     roughness: 0.3
                });
                ring = new THREE.Mesh(ringGeometry, ringMaterial);
                logoScene.add(ring);

                // 5D gateway vortex (inner core)
                const vortexGeometry = new THREE.SphereGeometry(2.5, 32, 32);
                 // Material with wireframe look and transparency
                const vortexMaterial = new THREE.MeshStandardMaterial({
                    color: 0x0044ff, // Bluish color
                    emissive: 0x0033cc, // Emissive color
                    emissiveIntensity: 0.5,
                    transparent: true,
                    opacity: 0.4,
                    wireframe: true
                });
                vortex = new THREE.Mesh(vortexGeometry, vortexMaterial);
                logoScene.add(vortex);

                // Particle stream (small spheres)
                const particleGeometry = new THREE.SphereGeometry(0.08, 8, 8); // Smaller particles
                const particleMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff }); // White
                for (let i = 0; i < 150; i++) { // Number of particles
                    const particle = new THREE.Mesh(particleGeometry, particleMaterial);
                    // Custom data for each particle's animation
                    particle.userData = {
                        angle: Math.random() * Math.PI * 2, // Start angle
                        radius: 2 + Math.random() * 1,      // Distance from center
                        height: -2 + Math.random() * 4,     // Height
                        speed: 0.01 + Math.random() * 0.01   // Speed
                    };
                    logoScene.add(particle);
                    particles.push(particle); // Add to particle list
                }

                // Lights for the scene
                const ambientLight = new THREE.AmbientLight(0x555555); // Basic illumination
                const pointLight = new THREE.PointLight(0x00ffaa, 1.5, 30); // Bright point light
                pointLight.position.set(7, 7, 7);
                logoScene.add(ambientLight);
                logoScene.add(pointLight);
            }

            // Sets up click interaction
            function setupInteractions() {
                const raycaster = new THREE.Raycaster();
                const mouse = new THREE.Vector2();
                const canvas = logoRenderer.domElement;

                // Event listener for clicks on the canvas
                canvas.addEventListener('click', (event) => {
                    // Calculate mouse position relative to the canvas
                    const rect = canvas.getBoundingClientRect();
                    mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                    mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

                    // Update raycaster
                    raycaster.setFromCamera(mouse, logoCamera);
                    // Check if the vortex was clicked
                    const intersects = raycaster.intersectObject(vortex);

                    if (intersects.length > 0) {
                        // Change vortex material color on click
                        vortex.material.color.set(Math.random() * 0xffffff); // Random color
                        vortex.material.emissive.set(vortex.material.color); // Adjust emissive color
                        console.log("Vortex geklickt!");
                    }
                });
            }

            // The main animation loop
            function animate() {
                requestAnimationFrame(animate); // Request next frame
                const t = clock.getElapsedTime(); // Time since start

                // Vortex pulsation (simple sine wave)
                const scale = 1 + Math.sin(t * 1.5) * 0.1;
                vortex.scale.set(scale, scale, scale);

                // Animate vortex emissive intensity
                const intensity = 0.5 + Math.abs(Math.sin(t * 1.5)) * 0.5;
                if (vortex.material.emissiveIntensity !== undefined) {
                     vortex.material.emissiveIntensity = intensity;
                }
                 // Animate ring emissive intensity slightly
                 if (ring.material.emissiveIntensity !== undefined) {
                     ring.material.emissiveIntensity = 0.6 + Math.abs(Math.sin(t * 0.8)) * 0.4;
                 }

                // Ring and vortex rotation
                ring.rotation.x += 0.005;
                ring.rotation.y += 0.01;
                vortex.rotation.y -= 0.002;

                // Particle movement
                particles.forEach(p => {
                    const userData = p.userData;
                    userData.angle += userData.speed; // Increase angle
                    // Recalculate position based on angle and radius
                    p.position.x = Math.cos(userData.angle) * userData.radius;
                    p.position.z = Math.sin(userData.angle) * userData.radius;
                    p.position.y = userData.height + Math.sin(userData.angle * 1.5) * 0.5; // Slight vertical oscillation
                });

                logoRenderer.render(logoScene, logoCamera); // Render the scene
            }

            // Adjusts renderer size and camera aspect ratio to canvas size
            function resize(width, height) {
                if (!logoRenderer || !logoCamera) return; // Ensure everything is initialized

                // Update camera aspect ratio
                logoCamera.aspect = width / height;
                logoCamera.updateProjectionMatrix();

                // Adjust renderer size
                logoRenderer.setSize(width, height);
            }

            // Call initialization
            init();

            // Return the resize function so it can be called from outside
            return {
                resize,
            };
        }

        // ----- Logo Initialization and Resize Handling -----
        try {
            // Create and initialize the logo
            const logoInstance = create3DLogo('logo-canvas');

            // Function to adjust logo size to its container
            const handleResize = () => {
                const container = document.getElementById('logo-container');
                // Check if container and logo instance with resize function exist
                if (container && logoInstance && typeof logoInstance.resize === 'function') {
                    // Use clientWidth/Height as they reflect the actual rendered size
                    logoInstance.resize(container.clientWidth, container.clientHeight);
                } else if (!container) {
                    console.warn("Logo-Container nicht gefunden fÃ¼r Resize.");
                } else if (!logoInstance || typeof logoInstance.resize !== 'function') {
                     console.warn("Logo-Instanz oder resize-Funktion nicht verfÃ¼gbar.");
                }
            };

            // Add event listener for window resize events
            window.addEventListener('resize', handleResize);

            // Initial resize adjustment after a short timeout (ensures CSS/layout are calculated)
            // Important if container size isn't fixed immediately.
            setTimeout(handleResize, 100);

        } catch (error) {
             console.error("Fehler bei der Initialisierung des 3D-Logos:", error);
             // Optional: Fallback display or error message in UI
             const logoContainer = document.getElementById('logo-container');
             if(logoContainer) {
                 // Simple text message as fallback
                 const errorMsg = document.createElement('p');
                 errorMsg.textContent = 'Logo konnte nicht geladen werden.';
                 errorMsg.style.color = 'red';
                 errorMsg.style.fontSize = '10px';
                 errorMsg.style.textAlign = 'center';
                 errorMsg.style.padding = '5px';
                 logoContainer.appendChild(errorMsg);
                 // Hide canvas if error occurs
                 const canvas = document.getElementById('logo-canvas');
                 if (canvas) canvas.style.display = 'none';
             }
        }
    </script>
</body>
</html>
